import { ImageResponse } from "next/og";
import { NextRequest } from "next/server";

export const runtime = "edge";

export async function GET(request: NextRequest) {
  const { searchParams } = new URL(request.url);
  const src = searchParams.get("src") || "";
  const title = searchParams.get("title") || "";

  return new ImageResponse(
    (
      <div
        style={{
          width: "100%",
          height: "100%",
          display: "flex",
          position: "relative",
          backgroundColor: "white",
          overflow: "hidden",
        }}
      >
        <img
          src={src}
          alt="Background"
          style={{
            position: "absolute",
            top: 0,
            left: 0,
            width: "100%",
            height: "100%",
            objectFit: "cover",
            objectPosition: "center",
          }}
        />
        <div
          style={{
            position: "absolute",
            left: "32px",
            bottom: "32px",
            backgroundColor: "white",
            padding: "16px",
            borderRadius: "8px",
            display: "flex",
            flexDirection: "column",
            maxWidth: "43rem",
          }}
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            xmlnsXlink="http://www.w3.org/1999/xlink"
            zoomAndPan="magnify"
            viewBox="22 429.9 762.92 152.18"
            preserveAspectRatio="xMidYMid meet"
            version="1.0"
            style={{ height: "8rem", width: "40rem" }}
          >
            <defs>
              <g></g>
              <clipPath id="4be4ecb5e2">
                <path d="M 62 527 L 182 527 L 182 582.074219 L 62 582.074219 Z M 62 527 " clip-rule="nonzero"></path>
              </clipPath>
              <clipPath id="dacf61ce2e">
                <path
                  d="M 53 429.898438 L 185 429.898438 L 185 499 L 53 499 Z M 53 429.898438 "
                  clip-rule="nonzero"
                ></path>
              </clipPath>
              <clipPath id="f99ee59e2e">
                <path d="M 88 479 L 210.632812 479 L 210.632812 517 L 88 517 Z M 88 479 " clip-rule="nonzero"></path>
              </clipPath>
            </defs>
            <g clip-path="url(#4be4ecb5e2)">
              <path
                fill="#000000"
                d="M 181.199219 533.554688 C 167.863281 569.058594 130.300781 589.546875 93.339844 579.542969 C 84.464844 577.148438 76.066406 572.882812 68.800781 567.242188 C 66.320312 565.339844 63.636719 563.332031 63.015625 560.039062 C 62.316406 556.519531 65.53125 553.386719 69.019531 554.050781 C 72.09375 554.398438 73.757812 556.371094 75.953125 558.058594 C 94.546875 572.820312 120.921875 575.902344 142.328125 565.484375 C 151.179688 561.128906 159.144531 554.523438 164.953125 546.527344 C 166.484375 544.449219 167.933594 542.054688 169.222656 539.8125 C 169.820312 538.746094 170.429688 537.332031 170.980469 536.242188 C 170.980469 536.242188 171.410156 535.34375 171.410156 535.34375 C 171.554688 535.039062 171.660156 534.730469 171.78125 534.417969 C 171.78125 534.417969 173.207031 530.707031 173.207031 530.707031 C 175.164062 525.164062 183.207031 527.984375 181.191406 533.5625 Z M 181.199219 533.554688 "
                fill-opacity="1"
                fill-rule="nonzero"
              ></path>
            </g>
            <g clip-path="url(#dacf61ce2e)">
              <path
                fill="#000000"
                d="M 53.558594 464.789062 C 53.394531 460.738281 55.664062 457.359375 58.335938 454.574219 C 60.78125 451.746094 63.542969 449.207031 66.378906 446.777344 C 81.609375 434.09375 101.488281 428.175781 121.171875 430.339844 C 153.933594 433.753906 181.320312 460.511719 184.628906 493.398438 C 185.066406 498.824219 177.328125 499.945312 176.230469 494.601562 C 169.023438 455.316406 127.488281 431.902344 90.542969 447.410156 C 82.058594 450.988281 74.34375 456.445312 68.300781 463.402344 C 66.082031 465.984375 64.316406 468.289062 60.683594 469.398438 C 57.425781 470.683594 53.671875 468.324219 53.558594 464.789062 Z M 53.558594 464.789062 "
                fill-opacity="1"
                fill-rule="nonzero"
              ></path>
            </g>
            <path
              fill="#000000"
              d="M 148.074219 535.859375 C 146.230469 536.679688 144.414062 537.035156 142.5 537.585938 C 141.566406 537.855469 140.605469 538.214844 139.695312 538.34375 C 138.78125 538.476562 137.914062 538.363281 137.070312 538.144531 C 133.6875 537.351562 130.324219 536.496094 126.980469 535.585938 C 120.292969 533.761719 113.695312 531.710938 107.171875 529.457031 C 81.09375 520.167969 43.945312 503.730469 26.886719 481.128906 C 20.992188 472.90625 19.558594 463.707031 27.515625 456.207031 C 30.878906 453.109375 35.8125 451.683594 40.207031 452.09375 C 42.546875 452.261719 44.300781 454.296875 44.128906 456.628906 C 43.976562 458.808594 42.195312 460.484375 40.058594 460.5625 C 37.691406 460.605469 35.613281 461.351562 34.101562 463.058594 C 33.175781 464.117188 32.414062 465.539062 32.25 466.972656 C 32.234375 468.132812 32.625 469.230469 33.097656 470.304688 C 35.269531 474.46875 38.597656 477.515625 42.265625 480.625 C 52.230469 488.734375 63.769531 494.777344 75.445312 500.179688 C 96.265625 509.597656 118.324219 516.738281 140.726562 521.324219 C 143.433594 521.65625 145.164062 524.210938 147.363281 525.617188 C 148.117188 526.21875 148.886719 526.855469 149.625 527.589844 C 152.183594 530.015625 151.320312 534.53125 148.074219 535.859375 Z M 148.074219 535.859375 "
              fill-opacity="1"
              fill-rule="nonzero"
            ></path>
            <path
              fill="#000000"
              d="M 104.625 551.011719 C 102.179688 551.1875 99.8125 551.058594 97.382812 551.144531 C 95.023438 551.109375 92.949219 549.871094 90.753906 549.179688 C 89.3125 548.648438 87.871094 548.097656 86.441406 547.53125 C 69.226562 540.726562 52.335938 532.433594 37.839844 520.761719 C 33.863281 517.386719 38.109375 511.257812 42.652344 513.789062 C 52.6875 519.90625 63.390625 524.804688 74.328125 529.101562 C 81.164062 531.796875 88.117188 534.21875 95.128906 536.441406 C 97.199219 537.230469 99.496094 537.429688 101.347656 538.738281 C 103.21875 540.25 105.226562 541.402344 107.121094 542.945312 C 110.34375 545.484375 108.675781 550.75 104.625 551.011719 Z M 104.625 551.011719 "
              fill-opacity="1"
              fill-rule="nonzero"
            ></path>
            <g clip-path="url(#f99ee59e2e)">
              <path
                fill="#000000"
                d="M 92.320312 479.917969 C 93.742188 479.132812 95.539062 479.734375 96.972656 479.988281 C 101.242188 480.625 105.253906 481.792969 109.105469 483.714844 C 114.222656 485.964844 119.390625 488.097656 124.613281 490.070312 C 142.648438 496.765625 161.40625 502.632812 180.640625 504.066406 C 185.878906 504.316406 197.921875 504.675781 200.117188 499.386719 C 201.382812 496.199219 200.570312 493.054688 197.878906 490.574219 C 194.148438 486.78125 199.136719 481.042969 203.398438 484.144531 C 210.558594 489.300781 212.585938 499.359375 207.675781 506.796875 C 194.507812 524.902344 146.167969 512.714844 127.847656 507.015625 C 119.453125 504.378906 111.175781 501.347656 103.027344 498.03125 C 98.78125 496.511719 95.042969 494.191406 91.664062 491.1875 C 91.664062 491.1875 89.925781 489.746094 89.925781 489.746094 C 89.636719 489.496094 89.375 489.214844 89.148438 488.847656 C 87.296875 485.664062 89.097656 481.296875 92.328125 479.910156 Z M 92.320312 479.917969 "
                fill-opacity="1"
                fill-rule="nonzero"
              ></path>
            </g>
            <g fill="#000000" fill-opacity="1">
              <g transform="translate(221.328011, 565.072763)">
                <g>
                  <path d="M 35.421875 1.171875 C 24.003906 1.171875 15.757812 -1.65625 10.6875 -7.3125 C 5.613281 -12.976562 3.078125 -22.101562 3.078125 -34.6875 L 3.078125 -46.984375 L 27.8125 -46.984375 L 27.8125 -31.328125 C 27.8125 -25.078125 29.8125 -21.953125 33.8125 -21.953125 C 36.0625 -21.953125 37.625 -22.609375 38.5 -23.921875 C 39.375 -25.242188 39.8125 -27.46875 39.8125 -30.59375 C 39.8125 -34.695312 39.320312 -38.085938 38.34375 -40.765625 C 37.375 -43.453125 36.132812 -45.695312 34.625 -47.5 C 33.113281 -49.3125 30.40625 -52.117188 26.5 -55.921875 L 15.65625 -66.75 C 7.269531 -74.945312 3.078125 -84.023438 3.078125 -93.984375 C 3.078125 -104.710938 5.539062 -112.882812 10.46875 -118.5 C 15.394531 -124.113281 22.59375 -126.921875 32.0625 -126.921875 C 43.382812 -126.921875 51.53125 -123.921875 56.5 -117.921875 C 61.476562 -111.921875 63.96875 -102.523438 63.96875 -89.734375 L 38.359375 -89.734375 L 38.203125 -98.375 C 38.203125 -100.03125 37.738281 -101.347656 36.8125 -102.328125 C 35.882812 -103.304688 34.59375 -103.796875 32.9375 -103.796875 C 30.988281 -103.796875 29.523438 -103.257812 28.546875 -102.1875 C 27.566406 -101.113281 27.078125 -99.644531 27.078125 -97.78125 C 27.078125 -93.6875 29.421875 -89.441406 34.109375 -85.046875 L 48.75 -71 C 52.164062 -67.675781 54.992188 -64.523438 57.234375 -61.546875 C 59.484375 -58.578125 61.289062 -55.066406 62.65625 -51.015625 C 64.019531 -46.960938 64.703125 -42.15625 64.703125 -36.59375 C 64.703125 -24.195312 62.429688 -14.800781 57.890625 -8.40625 C 53.359375 -2.019531 45.867188 1.171875 35.421875 1.171875 Z M 35.421875 1.171875 "></path>
                </g>
              </g>
            </g>
            <g fill="#000000" fill-opacity="1">
              <g transform="translate(282.663407, 565.072763)">
                <g>
                  <path d="M 5.5625 -125.75 L 38.796875 -125.75 C 48.847656 -125.75 56.019531 -122.503906 60.3125 -116.015625 C 64.601562 -109.523438 66.75 -100.035156 66.75 -87.546875 C 66.75 -75.046875 64.84375 -65.625 61.03125 -59.28125 C 57.226562 -52.9375 50.398438 -49.765625 40.546875 -49.765625 L 30.296875 -49.765625 L 30.296875 0 L 5.5625 0 Z M 31.765625 -72.46875 C 34.796875 -72.46875 37.015625 -73.023438 38.421875 -74.140625 C 39.835938 -75.265625 40.765625 -76.875 41.203125 -78.96875 C 41.648438 -81.070312 41.875 -84.078125 41.875 -87.984375 C 41.875 -93.253906 41.285156 -97.054688 40.109375 -99.390625 C 38.941406 -101.734375 36.597656 -102.90625 33.078125 -102.90625 L 30.296875 -102.90625 L 30.296875 -72.46875 Z M 31.765625 -72.46875 "></path>
                </g>
              </g>
            </g>
            <g fill="#000000" fill-opacity="1">
              <g transform="translate(345.609037, 565.072763)">
                <g>
                  <path d="M 35.578125 1.171875 C 25.421875 1.171875 17.707031 -1.925781 12.4375 -8.125 C 7.164062 -14.320312 4.53125 -23.03125 4.53125 -34.25 L 4.53125 -94.125 C 4.53125 -104.957031 7.164062 -113.128906 12.4375 -118.640625 C 17.707031 -124.160156 25.421875 -126.921875 35.578125 -126.921875 C 45.722656 -126.921875 53.429688 -124.160156 58.703125 -118.640625 C 63.972656 -113.128906 66.609375 -104.957031 66.609375 -94.125 L 66.609375 -34.25 C 66.609375 -22.9375 63.972656 -14.203125 58.703125 -8.046875 C 53.429688 -1.898438 45.722656 1.171875 35.578125 1.171875 Z M 35.578125 -21.953125 C 37.816406 -21.953125 39.328125 -22.925781 40.109375 -24.875 C 40.890625 -26.832031 41.28125 -29.566406 41.28125 -33.078125 L 41.28125 -94.5625 C 41.28125 -97.300781 40.914062 -99.523438 40.1875 -101.234375 C 39.457031 -102.941406 37.96875 -103.796875 35.71875 -103.796875 C 31.519531 -103.796875 29.421875 -100.625 29.421875 -94.28125 L 29.421875 -32.9375 C 29.421875 -29.320312 29.859375 -26.585938 30.734375 -24.734375 C 31.617188 -22.878906 33.234375 -21.953125 35.578125 -21.953125 Z M 35.578125 -21.953125 "></path>
                </g>
              </g>
            </g>
            <g fill="#000000" fill-opacity="1">
              <g transform="translate(410.604071, 565.072763)">
                <g>
                  <path d="M 5.5625 -125.75 L 44.203125 -125.75 C 50.359375 -125.75 55.117188 -124.359375 58.484375 -121.578125 C 61.847656 -118.796875 64.113281 -114.890625 65.28125 -109.859375 C 66.457031 -104.835938 67.046875 -98.421875 67.046875 -90.609375 C 67.046875 -83.484375 66.117188 -77.921875 64.265625 -73.921875 C 62.410156 -69.921875 59.191406 -67.140625 54.609375 -65.578125 C 58.410156 -64.796875 61.164062 -62.890625 62.875 -59.859375 C 64.582031 -56.835938 65.4375 -52.742188 65.4375 -47.578125 L 65.140625 0 L 40.546875 0 L 40.546875 -49.1875 C 40.546875 -52.695312 39.863281 -54.941406 38.5 -55.921875 C 37.132812 -56.898438 34.644531 -57.390625 31.03125 -57.390625 L 31.03125 0 L 5.5625 0 Z M 37.1875 -79.203125 C 40.695312 -79.203125 42.453125 -83.003906 42.453125 -90.609375 C 42.453125 -93.929688 42.304688 -96.421875 42.015625 -98.078125 C 41.722656 -99.742188 41.1875 -100.890625 40.40625 -101.515625 C 39.625 -102.148438 38.5 -102.46875 37.03125 -102.46875 L 31.1875 -102.46875 L 31.1875 -79.203125 Z M 37.1875 -79.203125 "></path>
                </g>
              </g>
            </g>
            <g fill="#000000" fill-opacity="1">
              <g transform="translate(474.281635, 565.072763)">
                <g>
                  <path d="M 16.390625 0 L 16.390625 -101.59375 L 1.46875 -101.59375 L 1.46875 -125.75 L 56.5 -125.75 L 56.5 -101.59375 L 41.578125 -101.59375 L 41.578125 0 Z M 16.390625 0 "></path>
                </g>
              </g>
            </g>
            <g fill="#000000" fill-opacity="1">
              <g transform="translate(526.101973, 565.072763)">
                <g>
                  <path d="M 35.421875 1.171875 C 24.003906 1.171875 15.757812 -1.65625 10.6875 -7.3125 C 5.613281 -12.976562 3.078125 -22.101562 3.078125 -34.6875 L 3.078125 -46.984375 L 27.8125 -46.984375 L 27.8125 -31.328125 C 27.8125 -25.078125 29.8125 -21.953125 33.8125 -21.953125 C 36.0625 -21.953125 37.625 -22.609375 38.5 -23.921875 C 39.375 -25.242188 39.8125 -27.46875 39.8125 -30.59375 C 39.8125 -34.695312 39.320312 -38.085938 38.34375 -40.765625 C 37.375 -43.453125 36.132812 -45.695312 34.625 -47.5 C 33.113281 -49.3125 30.40625 -52.117188 26.5 -55.921875 L 15.65625 -66.75 C 7.269531 -74.945312 3.078125 -84.023438 3.078125 -93.984375 C 3.078125 -104.710938 5.539062 -112.882812 10.46875 -118.5 C 15.394531 -124.113281 22.59375 -126.921875 32.0625 -126.921875 C 43.382812 -126.921875 51.53125 -123.921875 56.5 -117.921875 C 61.476562 -111.921875 63.96875 -102.523438 63.96875 -89.734375 L 38.359375 -89.734375 L 38.203125 -98.375 C 38.203125 -100.03125 37.738281 -101.347656 36.8125 -102.328125 C 35.882812 -103.304688 34.59375 -103.796875 32.9375 -103.796875 C 30.988281 -103.796875 29.523438 -103.257812 28.546875 -102.1875 C 27.566406 -101.113281 27.078125 -99.644531 27.078125 -97.78125 C 27.078125 -93.6875 29.421875 -89.441406 34.109375 -85.046875 L 48.75 -71 C 52.164062 -67.675781 54.992188 -64.523438 57.234375 -61.546875 C 59.484375 -58.578125 61.289062 -55.066406 62.65625 -51.015625 C 64.019531 -46.960938 64.703125 -42.15625 64.703125 -36.59375 C 64.703125 -24.195312 62.429688 -14.800781 57.890625 -8.40625 C 53.359375 -2.019531 45.867188 1.171875 35.421875 1.171875 Z M 35.421875 1.171875 "></path>
                </g>
              </g>
            </g>
            <g fill="#000000" fill-opacity="1">
              <g transform="translate(587.437353, 565.072763)">
                <g>
                  <path d="M 5.5625 0 L 5.5625 -125.75 L 30.59375 -125.75 L 30.59375 -80.8125 L 42.453125 -80.8125 L 42.453125 -125.75 L 67.484375 -125.75 L 67.484375 0 L 42.453125 0 L 42.453125 -57.09375 L 30.59375 -57.09375 L 30.59375 0 Z M 5.5625 0 "></path>
                </g>
              </g>
            </g>
            <g fill="#000000" fill-opacity="1">
              <g transform="translate(654.335408, 565.072763)">
                <g>
                  <path d="M 34.6875 1.171875 C 24.34375 1.171875 16.65625 -1.753906 11.625 -7.609375 C 6.601562 -13.460938 4.09375 -22.148438 4.09375 -33.671875 L 4.09375 -125.75 L 28.546875 -125.75 L 28.546875 -34.6875 C 28.546875 -30.6875 28.9375 -27.5625 29.71875 -25.3125 C 30.5 -23.070312 32.15625 -21.953125 34.6875 -21.953125 C 37.226562 -21.953125 38.890625 -23.050781 39.671875 -25.25 C 40.453125 -27.445312 40.84375 -30.59375 40.84375 -34.6875 L 40.84375 -125.75 L 65.296875 -125.75 L 65.296875 -33.671875 C 65.296875 -22.148438 62.78125 -13.460938 57.75 -7.609375 C 52.726562 -1.753906 45.039062 1.171875 34.6875 1.171875 Z M 34.6875 1.171875 "></path>
                </g>
              </g>
            </g>
            <g fill="#000000" fill-opacity="1">
              <g transform="translate(717.573829, 565.072763)">
                <g>
                  <path d="M 5.5625 -125.75 L 39.671875 -125.75 C 48.847656 -125.75 55.507812 -123.503906 59.65625 -119.015625 C 63.800781 -114.523438 65.875 -107.207031 65.875 -97.0625 L 65.875 -91.5 C 65.875 -79.488281 61.582031 -72.3125 53 -69.96875 C 58.269531 -68.601562 61.976562 -65.429688 64.125 -60.453125 C 66.269531 -55.484375 67.34375 -48.898438 67.34375 -40.703125 C 67.34375 -27.328125 65.335938 -17.195312 61.328125 -10.3125 C 57.328125 -3.4375 50.109375 0 39.671875 0 L 5.5625 0 Z M 35.28125 -78.46875 C 37.425781 -78.46875 38.890625 -79.269531 39.671875 -80.875 C 40.453125 -82.488281 40.84375 -84.757812 40.84375 -87.6875 L 40.84375 -100.28125 C 40.84375 -104.375 39.035156 -106.421875 35.421875 -106.421875 L 30.15625 -106.421875 L 30.15625 -78.46875 Z M 32.640625 -22.109375 C 39.179688 -22.109375 42.453125 -25.226562 42.453125 -31.46875 L 42.453125 -47.140625 C 42.453125 -50.941406 41.890625 -53.816406 40.765625 -55.765625 C 39.648438 -57.722656 37.675781 -58.703125 34.84375 -58.703125 L 30.15625 -58.703125 L 30.15625 -22.25 Z M 32.640625 -22.109375 "></path>
                </g>
              </g>
            </g>
          </svg>
          <div
            style={{
              marginLeft: "1rem",
              fontSize: "3rem",
              fontWeight: "bold",
              maxWidth: "100%",
              whiteSpace: "nowrap",
              overflow: "hidden",
              textOverflow: "ellipsis",
            }}
          >
            {title}
          </div>
        </div>
      </div>
    ),
    {
      width: 1200,
      height: 630,
    }
  );
}
